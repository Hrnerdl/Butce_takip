<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Finans Pro Max</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<div class="app-container">
    
    <aside class="sidebar">
        <header>
            <h1><i class="fas fa-wallet"></i> Finans Pro</h1>
            <button class="theme-toggle" onclick="toggleTheme()" title="Karanlık Mod">
                <i class="fas fa-adjust"></i>
            </button>
        </header>

        <div class="balance-card">
            <span id="current-status-title">GENEL DURUM</span>
            <h2 id="grand-total">0,00 ₺</h2>
            <small id="status-subtitle">Bağlanıyor...</small>
        </div>

        <nav class="nav-menu">
            <button class="nav-btn active" onclick="switchView('dashboard')"><i class="fas fa-chart-line"></i> Özet & Grafik</button>
            <button class="nav-btn" onclick="switchView('transactions')"><i class="fas fa-list-ul"></i> Hareketler</button>
            <button class="nav-btn" onclick="switchView('loans')"><i class="fas fa-university"></i> Kredi Planı</button>
        </nav>

        <div class="action-buttons">
            <button class="btn btn-green" onclick="openModal('income')"><i class="fas fa-plus"></i> Gelir Ekle</button>
            <button class="btn btn-red" onclick="openModal('expense')"><i class="fas fa-minus"></i> Harcama Ekle</button>
        </div>

        <div class="mini-settings">
            <button onclick="openModal('pdf')" class="btn-text strong"><i class="fas fa-file-pdf"></i> Rapor Al</button>
            <div class="backup-controls">
                <button onclick="exportData()" class="btn-icon" title="Yedek İndir"><i class="fas fa-download"></i></button>
                <label for="import-file" class="btn-icon" title="Yedek Yükle"><i class="fas fa-upload"></i></label>
                <input type="file" id="import-file" style="display:none" onchange="importData(this)">
                <button onclick="resetData()" class="btn-icon danger" title="Sıfırla"><i class="fas fa-trash"></i></button>
            </div>
        </div>
    </aside>

    <main class="main-content">
        
        <div id="view-dashboard" class="view-section active">
            <div class="table-header">
                <h2>Finansal Genel Bakış</h2>
                <select id="year-filter" onchange="renderDashboard()">
                    <option value="2026" selected>2026</option>
                    <option value="2027">2027</option>
                    <option value="2028">2028</option>
                </select>
            </div>

            <div class="chart-container-box">
                <canvas id="financeChart"></canvas>
            </div>
            
            <h3 class="section-sub-title">Aylık Nakit Akışı</h3>
            <div class="table-scroll-container">
                <table class="dashboard-table">
                    <thead>
                        <tr>
                            <th>Dönem</th>
                            <th class="text-right">Gelir</th>
                            <th class="text-right">Kredi (1/3)</th>
                            <th class="text-right">Harcama</th>
                            <th class="text-right">Net</th>
                        </tr>
                    </thead>
                    <tbody id="dashboard-body"></tbody>
                </table>
            </div>
        </div>

        <div id="view-transactions" class="view-section">
            <div class="table-header mobile-col">
                <h2>Hareket Geçmişi</h2>
                <div class="filter-group">
                    <input type="month" id="trans-month-filter" class="date-filter" onchange="renderTransactions()">
                </div>
            </div>
            
            <div class="filter-tabs">
                <button class="filter-tab active" onclick="setTransFilter('all')">Tümü</button>
                <button class="filter-tab" onclick="setTransFilter('income')">Gelir</button>
                <button class="filter-tab" onclick="setTransFilter('expense')">Gider</button>
            </div>
            
            <div id="transaction-list" class="transaction-list"></div>
        </div>

        <div id="view-loans" class="view-section">
            <div class="table-header">
                <h2>Kredi Taksitleri</h2>
                <button class="btn-sm" onclick="openModal('loan')"><i class="fas fa-plus"></i> Ekle</button>
            </div>
            <div id="loan-list-full" class="loan-grid"></div>
        </div>

    </main>
</div>

<div id="modal-overlay" class="modal-overlay">
    <div class="modal-card">
        <div class="modal-header">
            <h3 id="modal-title">İşlem</h3>
            <button onclick="closeModal()" class="close-icon"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
            <form id="active-form"></form>
        </div>
    </div>
</div>

<div id="pdf-template" style="display:none;">
    <div class="pdf-container">
        <div class="pdf-header">
            <h1>FİNANSAL DURUM RAPORU</h1>
            <p id="pdf-month-title">Dönem: --</p>
        </div>
        <div class="pdf-summary">
            <div class="p-box p-green"><span>TOPLAM GELİR</span><h3 id="pdf-total-inc">0 ₺</h3></div>
            <div class="p-box p-blue"><span>KREDİ (AYRILAN)</span><h3 id="pdf-total-loan">0 ₺</h3></div>
            <div class="p-box p-red"><span>HARCAMALAR</span><h3 id="pdf-total-exp">0 ₺</h3></div>
            <div class="p-box p-gray"><span>KALAN NET</span><h3 id="pdf-net">0 ₺</h3></div>
        </div>
        <div class="pdf-section">
            <h3><i class="fas fa-arrow-down"></i> Gelir Detayları</h3>
            <table class="pdf-table" id="pdf-table-inc"><thead><tr><th>Tarih</th><th>Açıklama</th><th class="tr">Tutar</th></tr></thead><tbody></tbody></table>
        </div>
        <div class="pdf-section">
            <h3><i class="fas fa-university"></i> Kredi Planı (Bu Ay)</h3>
            <table class="pdf-table" id="pdf-table-loan"><thead><tr><th>Taksit</th><th>Vade</th><th class="tr">Tutar</th></tr></thead><tbody></tbody></table>
        </div>
        <div class="pdf-section">
            <h3><i class="fas fa-arrow-up"></i> Harcama Detayları</h3>
            <table class="pdf-table" id="pdf-table-exp"><thead><tr><th>Tarih</th><th>Kategori</th><th>Açıklama</th><th class="tr">Tutar</th></tr></thead><tbody></tbody></table>
        </div>
        <div class="pdf-footer">Bu rapor Finans Pro tarafından oluşturulmuştur.</div>
    </div>
</div>

<script src="script.js"></script>
</body>
</html>
